# YouTube → RuTube: бизнес-логика

## Цель
Автоматическая миграция контента между связанными парами «YouTube‑канал → RuTube‑канал». Поддерживаются два режима синхронизации: «последнее» для актуальных публикаций и «архив» для переноса всей истории.

## Источники данных
Настройки связок каналов и режимы миграции хранятся во внутреннем сервисе, из которого рабочие процессы получают задания.

## Очереди и лимиты
Скачивание и загрузка ведутся через TOR для обхода ограничений. Между запросами выдерживаются интервалы: отдельные паузы для скачивания, загрузки и повторных попыток. Дополнительно действуют суточные лимиты на количество роликов и запросов.

## Обработка видео
Перед загрузкой названия и описания переводятся на русский язык. Видео скачиваются с помощью `yt-dlp` с заранее заданными параметрами. Система отслеживает ошибки 429 (Too Many Requests) и выполняет дедупликацию, чтобы исключить повторную обработку уже опубликованных роликов.

## Публикация в RuTube
Обработанные файлы публикуются в целевой RuTube‑канал, соответствующий исходному каналу YouTube.

## Статусы и отчётность
Все стадии обработки и публикации фиксируются в PostgreSQL. По завершении работы формируются отчёты о загруженных роликах и возникших ошибках.

## Исключения и ошибки
При ошибках операции откладываются с повторными попытками в рамках интервалов и лимитов. Фатальные сбои помечаются в статусах и отражаются в отчётах.

## Правила качества
В систему не загружаются ролики с дублирующимся содержимым или неполными метаданными. После перевода текстов выполняется ручная проверка выборки для поддержания качества публикаций.
